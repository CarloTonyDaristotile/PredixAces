

<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../bower_components/px-dropdown/px-dropdown.html">
<link rel="import" href="../../bower_components/px-dropdown/px-dropdown-content.html">
<link rel="import" href="../asset-browser/asset-browser.html">
<link rel="import" href="../seed-table/seed-table.html">
<link rel="import" href="../kpi-bar/kpi-bar.html">
<link rel="import" href="../../bower_components/google-map/google-map.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">

<dom-module id="rmd-view">
  <style>
  :host {   
    --iron-icon-width: 16px;
    --iron-icon-height: 16px;
  }
      google-map{
          height:100vh;
          width: 100vw;
      }
      
       /* Content Top Bar */
        .content-top-bar{
            background-color: #fff;
            /*display: inline-block;*/ float: left;
            vertical-align: top;
            width: 100%;
            height: 40px;
            padding: 10px;
            /*box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);*/
            z-index: 3;
            margin-right: 50px;
        }
        .content-top-bar-text-wrapper {
           margin-top: -33px;
            color: #95989A;
        }
        .content-top-bar-text-wrapper h6
        {
            font-weight: 300 !important;
            font-size: 18px;
            width: 200px;
            display: inline-block;
        }
        .content-top-bar-text-wrapper p
        {
            display: inline-block;
        }
        .truck-name
        {
            cursor: pointer;
            color: #42B4D2;
            margin-left: 20px;
        }
        .dropdown {
            position: relative;
            display: inline-block;
        }
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            min-width: 150px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
            display: none;
        }
        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }
        .dropdown-content a:hover {background-color: #f1f1f1; color: #42B4D2;}
        .dropdown:hover .dropdown-content {
            display: block;
        }
      
      /* Map */
.map
{
    background-color: #E4E4E4;
    /*display: inline-block*/   float: left;
     width: /*904.0468px*/ 75%;
    height: 100vh;
    z-index: -1;
  
}
/* Content Sidebar */
.content-sidebar
{
    background-color: #F7F7F7;
    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
    width: 290px;
    height: 100vh;
    float: left;
    
}
.content-sidebar .truck-name, .content-sidebar .truck-status, .content-sidebar .truck-artifacts
{
    border-bottom: 1px solid #E1E3E7;
    margin-left: 0px;
    padding: 20px;
}
.content-sidebar .truck-status, .content-sidebar .truck-artifacts
{
    padding-top: 0;
}
.content-sidebar .truck-assistance
{
    padding: 20px;
    margin-left: 70px;
}
.content-sidebar h4
{
    color: #42B4D2;
}
.content-sidebar ul
{
    list-style-type: none;
    margin: 0; padding: 0;
}
.content-sidebar li
{
    margin-bottom: 10px;
    margin-left: 0;
}
.truck-status, .truck-artifacts
{
    margin-left: 20px;
}
.warning-status
{
    color: #FF6E62;
}
.good-status
{
    color: #0BD861;
}
.truck-assistance-btn
{
    padding: 10px;
    background-color: #42B4D2;
    color: white;
    text-align: center;
    text-decoration: none;
    border: none;
    border-radius: 5px;
    font-size: 14px;
    
    
}
  </style>
  <template>

            
      <div class="content-top-bar">
            <div class="content-top-bar-text-wrapper">
                <h6>Transport Overview&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</h6>
                
                <p class="truck-amt">2 Trucks&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</p>
                
                <div class="dropdown">
                        <p class="truck-name">Truck 1<p style="font-size: 10px; color:#42B4D2;">&nbsp;&nbsp;V</p></p>
                    
                    
                        
                        <div class="dropdown-content">
                            <a href="#">Truck 2</a>
                        </div>
                   </div>
          
          
                
            </div>
        </div>
      
      <div class="content content-overview">
          <div class="content-sidebar">
                    <div class="truck-name">
                        Truck 1
                    </div>
                    
                    <div class="truck-status">
                        <h4>Status</h4>
                        <table class="w3-table">
                            <tr>
                              <td width="170">TEMPERATURE</td>
                              <td class="warning-status">WARNING</td>
                            </tr>
                            <tr>
                              <td>HUMDITY</td>
                              <td class="good-status">GOOD</td>
                            </tr>
                            <tr>
                              <td>GAS LEVEL</td>
                              <td class="good-status">GOOD</td>
                            </tr>
                        </table>
                    </div>
                    
                    <div class="truck-artifacts">
                        <h4>Artifacts</h4>
                        <ul>
                            <li class="good-status">Painting</li>
                            <li class="good-status">Pottery</li>
                            <li class="warning-status">Wax Figure</li>
                            
                        </ul>
                    </div>
                    
                    <div class="truck-assistance">
                        <button type="button" class="truck-assistance-btn">
                            Send Assitance
                        </button>
                    </div>
              
              <!--
                    <div id="demo1">demo</div>
              
                    <script>
                        /*var txt = '{  "name":"moosa",
                        "email":"xyz@gmail.com",
                        "contact":"12345"           }';

                        var parsedtext = JSON.parse(txt);*/
                        document.getElementById("demo1").setAttribute("id") = "hello";
                        
                    </script>
-->
              
                </div>
          
  <div class="map">
    <iron-ajax id="ajaxRequest"
        url="https://time-series-store-predix.run.aws-usw02-pr.ice.predix.io/v1/datapoints"
        handle-as="json"
        on-response="handleResponse"
        last-response="{{data}}"
        on-error="handleResponseError"
        method = "POST" >
    </iron-ajax>    

    <google-map fit-to-marker api-key="AIzaSyD3E1D9b-Z7ekrT3tbhl_dy8DCXuIuDDRc" id="map">
      <google-map-marker latitude="" longitude="" draggable="true"></google-map-marker>
    </google-map>  
      
 </div>


</div>


        
   
    
  </template>
  <script>// language="JavaScript" type="text/javascript" src="/js/jquery-1.2.6.min.js">

      
      // document.getElementsByName("google-map-marker").setAttribute("latitude") = "35"
      // make a new variable A
      // store data JSON "response" object to this newly created variable A
      
      
      
      
    Polymer({
      is: 'rmd-view',
      properties: {
          lat1 : {type: Number},
          lon1 : {type: Number},
      },
        ready: function() {
            var headers = {
                "Authorization" : "bearer eyJhbGciOiJSUzI1NiIsImtpZCI6ImxlZ2FjeS10b2tlbi1rZXkiLCJ0eXAiOiJKV1QifQ.eyJqdGkiOiI0Y2RmOGM1YTBkOWM0MWFhODU3MWNhYTZhNDc2NWY2ZiIsInN1YiI6ImFwcF9jbGllbnRfaWRfMTMiLCJzY29wZSI6WyJ0aW1lc2VyaWVzLnpvbmVzLmYzZTFlZjI3LTk1NDMtNGI1ZS1hMTVmLTE4NmVlZWVhMzZkMy5pbmdlc3QiLCJ0aW1lc2VyaWVzLnpvbmVzLmYzZTFlZjI3LTk1NDMtNGI1ZS1hMTVmLTE4NmVlZWVhMzZkMy5xdWVyeSIsInRpbWVzZXJpZXMuem9uZXMuZjNlMWVmMjctOTU0My00YjVlLWExNWYtMTg2ZWVlZWEzNmQzLnVzZXIiLCJ1YWEucmVzb3VyY2UiLCJvcGVuaWQiLCJ1YWEubm9uZSIsInByZWRpeC1hc3NldC56b25lcy41OGE2ZmEzYy0yM2QyLTQzNWMtOWIzNy03YjVlZWQ0NDVjNjgudXNlciJdLCJjbGllbnRfaWQiOiJhcHBfY2xpZW50X2lkXzEzIiwiY2lkIjoiYXBwX2NsaWVudF9pZF8xMyIsImF6cCI6ImFwcF9jbGllbnRfaWRfMTMiLCJncmFudF90eXBlIjoiY2xpZW50X2NyZWRlbnRpYWxzIiwicmV2X3NpZyI6IjEzZjdjMzgyIiwiaWF0IjoxNTAxNDIwNTI5LCJleHAiOjE1MDE0NjM3MjksImlzcyI6Imh0dHBzOi8vNzdhMzg2N2ItY2NlMC00MjNkLWE4ZWMtNDQ4ZDIwNDI2OTg0LnByZWRpeC11YWEucnVuLmF3cy11c3cwMi1wci5pY2UucHJlZGl4LmlvL29hdXRoL3Rva2VuIiwiemlkIjoiNzdhMzg2N2ItY2NlMC00MjNkLWE4ZWMtNDQ4ZDIwNDI2OTg0IiwiYXVkIjpbInVhYSIsIm9wZW5pZCIsInByZWRpeC1hc3NldC56b25lcy41OGE2ZmEzYy0yM2QyLTQzNWMtOWIzNy03YjVlZWQ0NDVjNjgiLCJ0aW1lc2VyaWVzLnpvbmVzLmYzZTFlZjI3LTk1NDMtNGI1ZS1hMTVmLTE4NmVlZWVhMzZkMyIsImFwcF9jbGllbnRfaWRfMTMiXX0.RCRJk7EavJ4VkJEwIrQ4oC3ds7L_QDmWCn3ZE68VukexVSSE4tKbiHCDzIFHFOFQnC-Qms6zQOGFG7Lp01VWKXWpGXB5PcigehdHA5Th1AaGhLJ3npxi-lqco_WVRBdRPLWhI07D6ZmXVB8N0dtAesc0T6l9hBPGy2i0k6R3VJqtXLt9b0dg6oZV0wPEx1V3Q_sM9iMRbog2bPMwfCIhf_A287Uko2rSkFKrfnujVy_0hqnc-kgBAwnBRzemEQwGZr6eGy5k4g1yPXMdwCMPABjl5HewfCYEk1R-wBmThoNrAR2onDpDNHSHBkAODGc_S4hRVGmhvSUv0r3s5b6aWQ",
                "Predix-Zone-Id" : "f3e1ef27-9543-4b5e-a15f-186eeeea36d3",
                "Content-Type" : "application/json"
            }
            
            var body = {
                "tags": [
                {
                  "name": "car-gps1",
                  "order": "desc"
                }
              ],    
              "start": 1501276077
            }
            
            this.$.ajaxRequest.headers = headers;
            this.$.ajaxRequest.body = body;
            console.log("here");
            this.$.ajaxRequest.generateRequest();  
        },
        handleResponse : function(){
            //console.log(this.data.tags.0.name);
            var data = this.get("data");
            var splt = data.tags[0].results[0].values[0][1];
            var ar = splt.split(",");
            var ns = ar[0].replace("N","").replace("S","");
            var ew = ar[1].replace("E","").replace("W","");
            //this.set("lat1",ns);
            ///this.set("lon1",ew);
            this.$.map.latitude = ns/100;
            this.$.map.longitude = -ew/100;
            
            //this.$.map.latitude = lat2 * Math.PI / 180 - lat1 * Math.PI / 180;
            //this.$.map.longitude = lon2 * Math.PI / 180 - lon1 * Math.PI / 180;
            
            debugger;
            console.log("lat" , ns);
            console.log("lon" , ew);
        },
        handleResponseError : function(){
            debugger;
        },
      
    });
      
      ////////////////////////////////////////
      ////////////////////////////////////////
      
  
      //var gpsdata = this.data;
      //var parsed = JSON.parse(gpsdata);
      //document.getElementById("demo").innerHTML = parsed.name;
      
      ////////////////////////////////////////////
      ////////////////////////////////////////////
      
  </script>
</dom-module>
